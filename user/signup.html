<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up</title>
    <link rel="icon" href="https://github.com/nammayatri/nammayatri/raw/main/public/favicon.ico">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="/nammayatri/user/auth.css">
<<<<<<< HEAD
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
=======
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
>>>>>>> 9a67047ad56c59b48d2e49212ac447469b35983d
</head>

<body>
    <div class="logo">
        <img src="https://pplx-res.cloudinary.com/image/upload/v1742056666/user_uploads/IqiVDJndBrZiqvR/NM-logo.jpg"
            alt="Namma Yatri Logo" width="150">
    </div>

    <div class="container">
        <!-- Signup Form -->
        <div class="form-container signup-form">
            <h2>Sign Up</h2>
            <form id="signupForm">
                <div class="input-group">
                    <label for="signupUsername">Username:</label>
                    <input type="text" id="signupUsername" name="signupUsername" placeholder="Enter your username"
                        required>
                </div>
                <div class="input-group">
                    <label for="signupEmail">Email:</label>
                    <input type="email" id="signupEmail" name="signupEmail" placeholder="Enter your email" required>
                </div>
                <div class="input-group">
                    <label for="signupPassword">Password:</label>
                    <input type="password" id="signupPassword" name="signupPassword" placeholder="Enter your password"
                        required>
                </div>
                <button type="button" class="green-button" onclick="signUp()">Sign Up</button>
                <div class="separator">
                    <span>OR</span>
                </div>
                <button type="button" class="google-btn black-button" onclick="googleSignUp()">
                    <i class="fab fa-google"></i> Sign up with Google
                </button>
                <p>Already have an account? <a href="/nammayatri/user/login.html">Login</a></p>
            </form>
        </div>
    </div>
<<<<<<< HEAD

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import {
            getAuth,
            createUserWithEmailAndPassword,
            signInWithPopup,
            GoogleAuthProvider,
            onAuthStateChanged
        } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";
        import {
            getFirestore,
            doc,
            setDoc
        } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBrI2UiORuWaRRj-YrvXoamAjEVcm5ZHXE",
            authDomain: "nammayatri-inya.firebaseapp.com",
            projectId: "nammayatri-inya",
            storageBucket: "nammayatri-inya.firebasestorage.app",
            messagingSenderId: "827244536000",
            appId: "1:827244536000:web:a357c9116be5e174674d25",
            measurementId: "G-2JT1L6L828"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Sign up function
        window.signUp = () => {
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const username = document.getElementById('signupUsername').value; // Get username

            createUserWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    // Signed in
                    const user = userCredential.user;
                    console.log("Sign up successful:", user);

                    // Save additional user data to Firestore
                    return setDoc(doc(db, "users", user.uid), {
                        email: user.email,
                        username: username // Save username
                    });
                })
                .then(() => {
                    // Data saved successfully
                    alert("Sign up successful! Data saved.");
                    window.location.href = '/user/login.html'; // Redirect to login page
                })
                .catch((error) => {
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    console.error("Sign up error:", errorCode, errorMessage);
                    alert("Sign up failed: " + errorMessage);
                });
        };

        // Google sign-up function
        window.googleSignUp = () => {
            const provider = new GoogleAuthProvider();

            signInWithPopup(auth, provider)
                .then((result) => {
                    // This gives you a Google Access Token. You can use it to access the Google API.
                    const credential = GoogleAuthProvider.credentialFromResult(result);
                    //const token = credential.accessToken; // Don't need this for basic auth
                    // The signed-in user info.
                    const user = result.user;
                    console.log("Google sign-up successful:", user);

                    // Save user data to Firestore
                    return setDoc(doc(db, "users", user.uid), {
                        email: user.email,
                        username: document.getElementById('signupUsername').value //taking from username 
                    });
                })
                .then(() => {
                    alert("Google sign-up successful! Data saved.");
                    window.location.href = '/user/login.html';
                })
                .catch((error) => {
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    console.error("Google sign-up error:", errorCode, errorMessage);
                    alert("Google sign-up failed: " + errorMessage);
                });
        };

         // Keep track of authentication state (optional, but good practice)
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // User is signed in, see docs for a list of available properties
                // https://firebase.google.com/docs/reference/js/auth.user
                const uid = user.uid;
                console.log("User is signed in with UID:", uid);
            } else {
                // User is signed out
                console.log("User is signed out");
            }
        });

    </script>

=======
    <script src="/nammayatri/user/auth.js"></script>
>>>>>>> 9a67047ad56c59b48d2e49212ac447469b35983d
</body>

</html>
