<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link rel="icon" href="https://github.com/nammayatri/nammayatri/raw/main/public/favicon.ico">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="/nammayatri/user/auth.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
    <div class="logo">
        <img src="https://pplx-res.cloudinary.com/image/upload/v1742056666/user_uploads/IqiVDJndBrZiqvR/NM-logo.jpg"
            alt="Namma Yatri Logo" width="150">
    </div>

    <div class="container">
        <!-- Login Form -->
        <div class="form-container login-form">
            <h2>Login</h2>
            <form id="loginForm">
                <div class="input-group">
                    <label for="loginEmail">Email:</label>
                    <input type="email" id="loginEmail" name="loginEmail" placeholder="Enter your email" required>
                </div>
                <div class="input-group">
                    <label for="loginPassword">Password:</label>
                    <input type="password" id="loginPassword" name="loginPassword" placeholder="Enter your password"
                        required>
                </div>
                <button type="button" class="green-button" onclick="login()">Login</button>
                <p>Don't have an account? <a href="/nammayatri/user/signup.html">Sign up</a></p>
            </form>
        </div>
    </div>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import {
            getAuth,
            signInWithEmailAndPassword
        } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBrI2UiORuWaRRj-YrvXoamAjEVcm5ZHXE",
            authDomain: "nammayatri-inya.firebaseapp.com",
            projectId: "nammayatri-inya",
            storageBucket: "nammayatri-inya.firebasestorage.app",
            messagingSenderId: "827244536000",
            appId: "1:827244536000:web:a357c9116be5e174674d25",
            measurementId: "G-2JT1L6L828"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Login function
        window.login = () => {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            signInWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    // Signed in
                    const user = userCredential.user;
                    console.log("Login successful:", user);

                    // Redirect to main.html
                    window.location.href = 'main.html';
                })
                .catch((error) => {
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    console.error("Login error:", errorCode, errorMessage);
                    alert("Login failed: " + errorMessage);
                });
        };
    </script>

</body>

</html>
